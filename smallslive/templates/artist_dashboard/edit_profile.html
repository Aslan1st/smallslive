{% extends "artist_dashboard/base.html" %}
{% load crispy_forms_tags %}
{% load static from staticfiles %}

{% block extra_head %}
  <script>
    var django = {jQuery: jQuery};
  </script>
  {{ form.media }}
  <link href="{% static 'css/selectize.bootstrap3.css' %}" rel="stylesheet">
{% endblock extra_head %}

{% block edit-profile-active %}active{% endblock %}

{% block title %}Add new artist{% endblock title %}

{% block content %}
  <section class="page-heading container">
        <h1>Edit my public profile</h1>
        <a target="_blank" class="page-heading__button-link" href="{{ request.user.artist.get_absolute_url }}">View on live site</a>
   </section>
  <section class="edit-public-profile container">
      <form action="{% url "artist_dashboard:edit_profile" %}" method="post" enctype="multipart/form-data">
          {% csrf_token %}
          <h2 class="edit-public-profile__heading">Basic information</h2>
          <div class="row">
              <div class="col-xs-12 col-sm-2">
                  <div class="form-group {% if form.salutation.errors  %}has-error{% endif %}">
                    {{ form.salutation.label_tag }}
                    {{ form.salutation }}
                    {% for error in form.salutation.errors %}
                        <p class="form-error-text">{{ error  }}</p>
                    {% endfor %}
                  </div>
              </div>
              <div class="col-xs-12 col-sm-5">
                  <div class="form-group {% if form.first_name.errors  %}has-error{% endif %}">
                    {{ form.first_name.label_tag }}
                    {{ form.first_name }}
                    {% for error in form.first_name.errors %}
                        <p class="form-error-text">{{ error  }}</p>
                    {% endfor %}
                  </div>
              </div>
              <div class="col-xs-12 col-sm-5">
                  <div class="form-group {% if form.last_name.errors  %}has-error{% endif %}">
                    {{ form.last_name.label_tag }}
                    {{ form.last_name }}
                    {% for error in form.last_name.errors %}
                        <p class="form-error-text">{{ error  }}</p>
                    {% endfor %}
                  </div>
              </div>
          </div>
          <div class="form-separator-light"></div>
          <h2 class="edit-public-profile__heading">My instruments</h2>
          <div id="div_id_instruments" class="form-group  {% if form.instruments.errors  %}has-error{% endif %}">
              <label for="id_instruments" class="control-label ">Instruments</label>
              {{ form.instruments }}
              {% for error in form.instruments.errors %}
                  <p class="form-error-text">{{ error  }}</p>
              {% endfor %}
          </div>
          <div class="form-separator-light"></div>
          <h2 class="edit-public-profile__heading">Biography</h2>
          <div id="div_id_biography" class="form-group {% if form.biography.errors  %}has-error{% endif %}">
              {{ form.biography }}
              {% for error in form.biography.errors %}
                  <p class="form-error-text">{{ error  }}</p>
              {% endfor %}
          </div>
          <div class="form-separator-light"></div>
          <div class="form-group {% if form.website.errors  %}has-error{% endif %}">
                    {{ form.website.label_tag }}
                    {{ form.website }}
                    {% for error in form.website.errors %}
                        <p class="form-error-text">{{ error  }}</p>
                    {% endfor %}
                  </div>
          <div class="form-separator-light"></div>
          <h2 class="edit-public-profile__heading">Photo</h2>
          <div class="form-group {% if form.photo.errors  %}has-error{% endif %}">
            {{ form.photo.label_tag }}
            {{ form.photo }}
            {% for error in form.photo.errors %}
                <p class="form-error-text">{{ error  }}</p>
            {% endfor %}
          </div>
          <div id="div_id_cropping" class="form-group {% if form.photo.errors  %}has-error{% endif %}">
            <p class="help">Enable cropping</p>
            {{ form.cropping }}
          </div>
          <input type="submit" name="submit" class="admin-interface__form__button" value="Save">
      </form>
  </section>
{% endblock content %}

{% block extra_js %}
  <script type="text/javascript" src="{% static 'js/selectize.min.js' %}"></script>
  <script>
    $("#id_instruments").selectize();
  </script>
  {% if request.GET.popup %}
    <script>
        window.onunload = refreshParent;
        function refreshParent() {
            window.opener.location.reload();
        }
    </script>
  {% endif %}
{% endblock extra_js %}