{% extends "smalls_base.html" %}
{% load add_get_parameter %}
{% load static from staticfiles %}
{% load thumbor_tags %}

{% block title %}Metrics payout{% endblock %}

{% block content %}

    <div class="content-wrapper">
        <form method="post" action="{% url "artist_dashboard:metrics_payout" %}">
            <section class="page-heading container">
                <h1>SmallsLIVE Payout Calculation Admin:</h1>
            </section>
            <section class="payout-calculator">
                {% csrf_token %}
                {{ form.errors }}
                <div class="payout-calculator__input"><span class="payout-calculator__input__label">Period revenue:</span><input class="payout-calculator__text-input" type="number" name="revenue" {% if form.revenue.value %}value="{{ form.revenue.value }}"{% endif %} placeholder="Enter value: 0000.00"></div>
                <div class="payout-calculator__input"><span class="payout-calculator__input__label">Period costs:</span><input class="payout-calculator__text-input" type="number" name="operating_cost" {% if form.operating_cost.value %}value="{{ form.operating_cost.value }}"{% endif %} placeholder="Enter value: 0000.00"></div>
                <div class="payout-calculator__input"><span class="payout-calculator__input__label">Period start date:</span><span class="payout-calculator__date-picker" id="payout-calculator__date-picker-start"><input class="" type="text" name="period_start" readonly><i class="fa fa-caret-down"></i></span></div>
                <div class="payout-calculator__input"><span class="payout-calculator__input__label">Period end date:</span><span class="payout-calculator__date-picker" id="payout-calculator__date-picker-end"><input class="" type="text" name="period_end" readonly><i class="fa fa-caret-down"></i></span></div>
                <div class="payout-calculator__instructions">
                    <p>Please select above the starting date and ending date for which you want to calculate the payout amounts for each artist.</p>
                </div>
                <div class="payout-calculator__set-final__container">
                    <div class="payout-calculator__set-final__checkbox-container">
                        <input type="checkbox" class="payout-calculator__set-final__checkbox" name="save_earnings" id="save_earnings">
                        <label for="save_earnings" class="payout-calculator__set-final__checkbox-label">Set these calculated values as final</label>
                    </div>
                    <div class="payout-calculator__instructions warning">
                        <p>Be aware that if you set this checkbox above as enabled, the values that get calculated for this period will be set as default for the respective period and will be displayed to artists through their dashboards.</p>
                    </div>
                </div>
                <button type="submit" class="payout-calculator__submit-button">Calculate</button>
            </section>
        </form>
    </div>
{% endblock content %}

{% block extra_js %}
          <script src="{% static 'js/bootstrap-select.js' %}"></script>
          <script src="{% static 'js/dashboard-base.js' %}"></script>


          <!-- Bootstrap datepicker JavaScript -->
          <script src="{% static 'js/bootstrap-datepicker.js' %}"></script>
          <script src="{% static 'js/metrics_datepicker.js' %}"></script>
          <script>
            var $datePickerStart = $('#payout-calculator__date-picker-start input');
            $datePickerStart.datepicker({
                format: 'yyyy-mm-dd',
                minViewMode: "days",
                orientation: "top auto",
                startDate: new Date(2015, 11-1, 1),
                autoclose: true
            });

            var $datePickerEnd = $('#payout-calculator__date-picker-end input');
            $datePickerEnd.datepicker({
                format: 'yyyy-mm-dd',
                minViewMode: "days",
                orientation: "top auto",
                autoclose: true
            });

            var start_date = new Date({{ form.fields.period_start.initial.year }}, {{ form.fields.period_start.initial.month }}-1, {{ form.fields.period_start.initial.day}});
            var end_date = new Date({{ form.fields.period_end.initial.year }}, {{ form.fields.period_end.initial.month }}-1, {{ form.fields.period_end.initial.day}});
            $datePickerStart.datepicker("setDate", start_date);
            $datePickerEnd.datepicker("setDate", end_date);
          </script>
{% endblock %}
