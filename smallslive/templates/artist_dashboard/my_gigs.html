{% extends "artist_dashboard/base.html" %}
{% load add_get_parameter %}
{% load static from staticfiles %}
{% load thumbor_tags %}

{% block my-events-active %}active{% endblock %}


{% block content %}
  <section class="page-heading container">
      <h1>My events:</h1>
  </section>
  <section class="events__filters container">
      <ul class="flexbox-equal-height">
          <li class="events__filters__heading">
              Filters:
          </li>
          <li class="events__filters__group">
              <ul>
                  <li {% if request.GET.audio_filter %}class="active"{% endif %}>Audio:</li>
                  <li {% if request.GET.audio_filter == "Published" %}class="active"{% endif %}><a href="{% add_get audio_filter="Published" page=None %}">Published</a> {% if request.GET.audio_filter == "Published" %}<a href="{% add_get audio_filter="" page=None %}"> <i class="fa fa-remove"></i></a>{% endif %}</li>
                  <li {% if request.GET.audio_filter == "Hidden" %}class="active"{% endif %}><a href="{% add_get audio_filter="Hidden" page=None %}">Private</a> {% if request.GET.audio_filter == "Hidden" %}<a href="{% add_get audio_filter="" page=None %}"> <i class="fa fa-remove"></i></a>{% endif %}</li>
                  <li {% if request.GET.audio_filter == "None" %}class="active"{% endif %}><a href="{% add_get audio_filter="None" page=None %}">Not available</a> {% if request.GET.audio_filter == "None" %}<a href="{% add_get audio_filter="" page=None %}"> <i class="fa fa-remove"></i></a>{% endif %}</li>
              </ul>
          </li>
          <li class="events__filters__group">
              <ul>
                  <li {% if request.GET.video_filter %}class="active"{% endif %}>Video:</li>
                  <li {% if request.GET.video_filter == "Published" %}class="active"{% endif %}><a href="{% add_get video_filter="Published" page=None %}">Published</a> {% if request.GET.video_filter == "Published" %}<a href="{% add_get video_filter="" page=None %}"> <i class="fa fa-remove"></i></a>{% endif %}</li>
                  <li {% if request.GET.video_filter == "Hidden" %}class="active"{% endif %}><a href="{% add_get video_filter="Hidden" page=None %}">Private</a> {% if request.GET.video_filter == "Hidden" %}<a href="{% add_get video_filter="" page=None %}"> <i class="fa fa-remove"></i></a>{% endif %}</li>
                  <li {% if request.GET.video_filter == "None" %}class="active"{% endif %}><a href="{% add_get video_filter="None" page=None %}">Not available</a> {% if request.GET.video_filter == "None" %}<a href="{% add_get video_filter="" page=None %}"> <i class="fa fa-remove"></i></a>{% endif %}</li>
              </ul>
          </li>
          <li class="events__filters__group">
              <ul>
                  <li {% if request.GET.leader_filter %}class="active"{% endif %}>Leader status:</li>
                  <li {% if request.GET.leader_filter == "true" %}class="active"{% endif %}><a href="{% add_get leader_filter="true" page=None %}">Leader</a> {% if request.GET.leader_filter == "true" %}<a href="{% add_get leader_filter="" page=None %}"> <i class="fa fa-remove"></i></a>{% endif %}</li>
                  <li {% if request.GET.leader_filter == "false" %}class="active"{% endif %}><a href="{% add_get leader_filter="false" page=None %}">Sideman</a> {% if request.GET.leader_filter == "false" %}<a href="{% add_get leader_filter="" page=None %}"> <i class="fa fa-remove"></i></a>{% endif %}</li>
              </ul>
          </li>
          <li class="events__filters__group">
              <a class="clear-toggle" href="{% url "artist_dashboard:my_gigs" %}"><i class="fa fa-remove"></i> Clear filters</a>
          </li>
      </ul>
  </section>
  <section class="events__list container">
      <ul>
        {% for gig_info in gigs %}
          {% with event=gig_info.event  %}
          <!-- single event row -->
          <li class="event-row flexbox-equal-height">
              <div class="hidden-xs hidden-sm col-md-2 event-row__image">
                  {% if event.photo %}
                      {% if gig_info.is_leader %}
                          <a href="{% url "artist_dashboard:event_edit" pk=event.id slug=event.slug %}">
                            <img src="{% thumbor_url event.photo.url|urlencode height=170 width=170 smart=True %}" alt=""/>
                          </a>
                      {% else %}
                          <a href="{% url "artist_dashboard:event_detail" pk=event.id slug=event.slug %}">
                            <img src="{% thumbor_url event.photo.url|urlencode height=170 width=170 smart=True %}" alt=""/>
                          </a>
                      {% endif %}
                  {% else %}
                      {% if gig_info.is_leader %}
                          <a href="{% url "artist_dashboard:event_edit" pk=event.id slug=event.slug %}">
                            <img src="{% static 'image/no-event-photo-thumbnail.jpg' %}" alt=""/>
                          </a>
                      {% else %}
                          <a href="{% url "artist_dashboard:event_detail" pk=event.id slug=event.slug %}">
                            <img src="{% static 'image/no-event-photo-thumbnail.jpg' %}" alt=""/>
                          </a>
                      {% endif %}
                  {% endif %}
              </div>
              <div class="col-xs-12 col-sm-8 col-md-7 event-row__description">
                  <p class="event-row__description__date">{{ event.listing_date|date:"l, F d, Y" }}  |  {{ event.start|date:"g:i A" }} - {{ event.end|date:"g:i A" }}</p>
                  {% if gig_info.is_leader %}
                    <a class="event-row__description__name" href="{% url "artist_dashboard:event_detail" pk=event.id slug=event.slug %}">{{ event.full_title }} {% if gig_info.is_leader %}<span class="event-row__is-leader">leader</span>{% endif %}</a>
                  {% else %}
                    <a class="event-row__description__name" href="{% url "artist_dashboard:event_detail" pk=event.id slug=event.slug %}">{{ event.full_title }} {% if gig_info.is_leader %}<span class="event-row__is-leader">leader</span>{% endif %}</a>
                  {% endif %}
                  <p class="event-row__description__label">Artists:</p>
                  <p class="event-row__description__artists">
                    {% for gig_info in event.get_performers %}
                      {{ gig_info.artist.full_name }} <span class="instrument">({{ gig_info.role }})</span>{% if not forloop.last %}  // {% endif %}
                    {% endfor %}
                  </p>
              </div>
              <div class="col-xs-12 col-sm-4 col-md-3 event-row__info">
                  <div class="col-xs-4 event-row__info__audio">
                      <i class="fa fa-volume-down {{ event.audio_status }}"></i>
                      <p class="event-row__info__label">Event audio</p>
                      <p class="event-row__info__status {{ event.audio_status }}">{{ event.audio_status|capfirst }}</p>
                  </div>
                  <div class="col-xs-4 event-row__info__video">
                      <i class="fa fa-video-camera {{ event.video_status }}"></i>
                      <p class="event-row__info__label">Event video</p>
                      <p class="event-row__info__status {{ event.video_status }}">{{ event.video_status|capfirst }}</p>
                  </div>
                  {% if gig_info.is_leader %}
                      <a class="col-xs-4 event-row__info__edit-button" href="{% url "artist_dashboard:event_edit" pk=event.id slug=event.slug %}">
                          <i class="fa fa-edit"></i>
                          <p class="event-row__info__label">Event details / edit</p>
                      </a>
                  {% else %}
                      <a class="col-xs-4 event-row__info__edit-button" href="{% url "artist_dashboard:event_detail" pk=event.id slug=event.slug %}">
                          <i class="fa fa-align-center"></i>
                      <p class="event-row__info__label">Event details</p>
                      </a>
                  {% endif %}
              </div>
          </li>
          {% endwith %}
        {% endfor %}
      </ul>
  </section>
  <section class="page-pagination container">
      <p class="search-pagination-info">Showing results {{ page_obj.start_index }}-{{ page_obj.end_index }} of {{ paginator.count }}</p>
          {% if page_obj.has_previous or page_obj.has_next %}
                <div class="search-pagination">
                  {% if page_obj.has_previous %}<a href="{% add_get page=page_obj.previous_page_number %}"><span class="search-pagination__previous fa fa-caret-left"></span></a>{% endif %}
                  {% if show_first %}
                    <a href="{% add_get page=1 %}"><span class="search-pagination__page {% if page_obj.number == 1 %}active{% endif %}">1</span></a>
                    ...
                  {% endif %}
                  {% for page in page_numbers %}
                    <a href="{% add_get page=page %}"><span class="search-pagination__page {% if page == page_obj.number %}active{% endif %}">{{ page }}</span></a>
                  {% endfor %}
                  {% if show_last %}
                    ...
                    <a href="{% add_get page=paginator.num_pages %}"><span class="search-pagination__page {% if page_obj.number == paginator.num_pages %}active{% endif %}">{{ paginator.num_pages }}</span></a>
                  {% endif %}
                  {% if page_obj.has_next %}<a href="{% add_get page=page_obj.next_page_number %}"><span class="search-pagination__next fa fa-caret-right"></span></a>{% endif %}

                </div>
            {% endif %}
  </section>
{% endblock content %}