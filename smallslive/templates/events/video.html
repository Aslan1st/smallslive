{% extends "base.html" %}
{% load static %}
{% block bodyclass %}event{% endblock bodyclass %}
{% block extra_css %}
  <link rel="stylesheet" href="//code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">
{% endblock extra_css %}
{% block extra_js %}
  <script type="text/javascript" src="//code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
  <script type="text/javascript" src="/static/js/jQuery.jPlayer.2.6.0/jquery.jplayer.min.js"></script>
  <script type="text/javascript">
  $(document).ready(function(){
    $("#jquery_jplayer_1").jPlayer({
      ready: function () {
        $(this).jPlayer("setMedia", {
          m4v: "http://orchestrotica.com/media/kit2009/index_files/Andalucia_HD.mp4",
          poster: "http://orchestrotica.com/media/kit2009/index_files/poster_andalucia.jpg"
        });
      },
      size: {
  			width: "100%", 
  			cssClass: "video-player-controls"
  		},
      swfPath: "/static/js/jQuery.jPlayer.2.6.0/",
      supplied: "m4v",      
  		smoothPlayBar: true,
  		keyEnabled: true,
  		remainingDuration: true,
  		toggleDuration: true
    });
  });
  </script>
{% endblock extra_js %}
{% comment %}
sample thumbors:
      <img src="{% thumbor_url event.photo.url|urlencode width=100 height=100 smart=True %}" class="headshot" /> <!-- 100x100 with smart crop (should detect faces) -->
      <img src="{% thumbor_url event.photo.url|urlencode width=200 %}" class="200w" width="200w_proportional"/> <!-- width=200 height=proportional -->
      <img src="{% thumbor_url event.photo.url|urlencode width=200 height="orig" %}" class="200w_original" width="200"/> <!-- width=200 height=original-->
      <img src="{% thumbor_url event.photo.url|urlencode width=300 fit_in=True %}" class="300w" /> <!-- resizes larger to 300, otherwise keep the original width, must be proportional-->
      {{ event.description }}
{% endcomment %}
{% load thumbor_tags %}
{% block title %}{{ event.display_title }} - {{ event.start }} in NYC w/   
 
    {{ performers.artist_info.artist.first_name.all|join:", " }}
 
{% endblock title %}
{% block content %}
{% if user.is_superuser %}<a href="{% url "event_edit" pk=event.id %}">Edit this event</a>{% endif %}
<h1>{% if request.GET.islive %}<span class="label label-primary">Live Now</span> {% endif %}{{ event.display_title }}</h1>
<div class="row">
  <div class="col-sm-8">
    {% if request.GET.isfuture %}
      <p>{{ event.start }}, {{ event.date_freeform }}</p>
    {% endif %}
    {% if event.subtitle %}
      <p>{{ event.subtitle }}</p>
    {% endif %}
    {% if request.GET.isfuture %}
        {% if event.photo %}
          <div class="well" style="text-align:center;padding:8em 8em">    
            <img src="{{ event.photo.url }}" class="img-responsive"  />
          </div>
        {% endif %}
    {% else %}
      {% if request.GET.mediaUnavailable %}
        <div class="alert alert-info">Video for this show is being processed and will be available here soon.</div>
        {% if event.photo %}
          <div class="well" style="text-align:center;padding:8em 8em">    
            <img src="{{ event.photo.url }}"  />
          </div>
        {% endif %}
      {% else %}
        <div class="video-player">
          <div id="jquery_jplayer_1"></div>
          <div id="jp_container_1">
            <a href="#" class="jp-play"><span class="glyphicon glyphicon-play"></span></a>
            <a href="#" class="jp-pause"><span class="glyphicon glyphicon-pause"></span></a>
          </div>
        </div> 
        <p class="event_date">Recorded {{ event.start }}, {{ event.date_freeform }}</p>
      {% endif %}
    {% endif %}
    {# start track list #}
    <h4>(7) tracks available for sale from this concert:</h4>
    <table class="table table-striped">
      <thead>
        <tr>
          <th></th>
          <th>Song</th>
          <th>Composer</th>
          <th>Length</th>
          <th>Price</th>
          <th>Video cue</th>
        </tr>
      </thead>
      <tbody>
        {% include 'blocks/track-name.html' %}
        {% include 'blocks/track-name.html' %}
        {% include 'blocks/track-name.html' %}
        {% include 'blocks/track-name.html' %}
        {% include 'blocks/track-name.html' %}
        {% include 'blocks/track-name.html' %}
        {% include 'blocks/track-name.html' %}
      </tbody>
    </table>
    {# end track list #}
    {# start musician list #}
    <h2>featuring:</h2> 
    {% for artist_info in performers %}
      <div class="sideman">
        <a href="{% url "artist_detail" pk=artist_info.artist.id %}">
        {% if artist_info.artist.photo.url != "" %}
          <img src="{% thumbor_url artist_info.artist.photo.url|urlencode width=80 height=80 smart=True %}" class="img-responsive artist-photo pull-left" />
        {% else %} 
          <img src="{% static 'image/photo-unavailable-square.svg' %}" width="80" height="80" class="img-responsive artist-photo pull-left" />
        {% endif %}
        <h3>{{ artist_info.artist.full_name }}</h3>
        {{ artist_info.artist.instruments.all|join:", " }} 
        <span class="media-count">(<span class="glyphicon glyphicon-music"></span> 6)</span>
        </a>
      </div>
    {% endfor %} 
    {# end musician list #}
    {% if event.description %}  
      <div class="description well"> 
        {{ event.description|safe }}
      </div>
    {% endif %}
  </div>
  <div class="col-sm-4">
  {% if request.GET.hascd %}
  <div class="well">
    <img src="http://beta.asoundstrategy.com/sitemaster/userUploads/site372/SL0039_PETERBERNSTEIN1.jpg" alt="{album title}" style="" class="img-responsive pull-right artist-photo" />
    <p>This event was released on CD in 2007.</p> 
    <p>CD: $15, Download: $10</p>
    <p><a class="btn btn-primary btn-lg" role="button">Buy CD or Download</a></p>
     
  </div>
  {% endif %}
  
    {% for artist_info in performers %}
      {% if artist_info.is_leader %}
      <h4>Recent Videos by {{ artist_info.artist.full_name }}</h4>
      <table class="table">
        <tbody>
          <tr>
            <td>[playButton]</td>
            <td><a href="{% url "event_detail" pk=412%}">{ pasteventwithaudio.date } - { pasteventwithaudio.displaytitle } </a></td>
          </tr>
          <tr>
            <td>[playButton]</td>
            <td><a href="{% url "event_detail" pk=412%}">{ pasteventwithaudio.date } - { pasteventwithaudio.displaytitle } </a></td>
          </tr>
          <tr>
            <td>[playButton]</td>
            <td><a href="{% url "event_detail" pk=412%}">{ pasteventwithaudio.date } - { pasteventwithaudio.displaytitle } </a></td>
          </tr> 
        </tbody>
      </table> 
      <p><a href="{% url "artist_detail" pk=412%}">Browse all (6) videos from {{ artist_info.artist.full_name }}</a></p>
      {% endif %}
    {% endfor %}

  </div>
</div>    
<div class="dev">
  <h1>Alternate States:</h1>
  <ul>
    <li><a href="./?isfuture=1">Future/upcoming event</a> {isfuture}</li>
    <li><a href="./?islive=1">Live now event</a> {islive}</li>
    <li><a href="./?">Past event</a> (Default view)</li>
    <li><a href="./?hascd=1">Past event, w/ CD</a> {hascd} </li>
    <li><a href="./?mediaUnavailable=1">Past event, no video</a> {mediaUnavailable}</li>
    <li><a href="./?noTracks=1">No track listing</a> {noTracks}</li>
  </ul>
  <h1>Dev notes</h1>
  <Ul> 
    <li><code>1</code> -  </li> 
  </Ul>
</div>

{% endblock content %}
