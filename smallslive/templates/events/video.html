{% extends "base.html" %}
{% load static %}
{% block bodyclass %}event{% endblock bodyclass %}
{% block extra_css %}
  <link rel="stylesheet" href="//code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">
{% endblock extra_css %}
{% block extra_js %}
  <script type="text/javascript" src="//code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
  <script type="text/javascript" src="/static/js/jQuery.jPlayer.2.6.0/jquery.jplayer.min.js"></script>
  <script type="text/javascript">
  $(document).ready(function(){
    $("#jquery_jplayer_1").jPlayer({
      ready: function () {
        $(this).jPlayer("setMedia", {
          m4v: "http://orchestrotica.com/media/kit2009/index_files/Andalucia_HD.mp4",
          poster: "http://orchestrotica.com/media/kit2009/index_files/poster_andalucia.jpg"
        });
      },
      size: {
  			width: "100%", 
  			cssClass: "video-player-controls"
  		},
      swfPath: "/static/js/jQuery.jPlayer.2.6.0/",
      supplied: "m4v",      
  		smoothPlayBar: true,
  		keyEnabled: true,
  		remainingDuration: true,
  		toggleDuration: true
    });
  });
  </script>
{% endblock extra_js %}
{% comment %}
sample thumbors:
      <img src="{% thumbor_url event.photo.url|urlencode width=100 height=100 smart=True %}" class="headshot" /> <!-- 100x100 with smart crop (should detect faces) -->
      <img src="{% thumbor_url event.photo.url|urlencode width=200 %}" class="200w" width="200w_proportional"/> <!-- width=200 height=proportional -->
      <img src="{% thumbor_url event.photo.url|urlencode width=200 height="orig" %}" class="200w_original" width="200"/> <!-- width=200 height=original-->
      <img src="{% thumbor_url event.photo.url|urlencode width=300 fit_in=True %}" class="300w" /> <!-- resizes larger to 300, otherwise keep the original width, must be proportional-->
      {{ event.description }}
{% endcomment %}
{% load thumbor_tags %}
{% block title %}{{ event.title }} - {{ event.start }} in NYC w/ {{ event.performers.all|join:", " }}{% endblock title %}
{% block content %}
<div class="page-header">
  <h1>{% if request.GET.islive %}<span class="label label-primary">Live Now</span> {% endif %}{{ event.title }}{% if user.is_superuser %}<small><a href="{% url "event_edit" pk=event.id %}">Edit this event</a></small>{% endif %}</h1>
  <p class="event-date">{% if not request.GET.isfuture %}Recorded{% endif %} {{ event.start }}, {{ event.date_freeform }}</p>
</div>
<div class="row">
  <div class="col-sm-8">
    {% if request.GET.isfuture %}
        {% if event.photo %}
          <div>    
            <img src="{{ event.photo.url }}" class="img-responsive"  />
          </div>
        {% endif %}
    {% else %}
      {% if request.GET.mediaUnavailable %}
        <div class="alert alert-info">Video for this show is being processed and will be available here soon.</div>
        {% if event.photo %}
          <div class="well" style="text-align:center;padding:8em 8em">    
            <img src="{{ event.photo.url }}"  />
          </div>
        {% endif %}
      {% else %}
        {% if request.GET.hascd %}  
          <div class="cd">
           <img src="{% thumbor_url 'http://beta.asoundstrategy.com/sitemaster/userUploads/site372/SL0039_PETERBERNSTEIN1.jpg'|urlencode width=100 height=100 smart=True %}" class="pull-left img-responsive" /> 
            <h6>This event was produced into a CD:</h6>
            <h4 class="text-primary">{{ event.dtitle }}</h4>
            <p class="text-muted">Released in Jan, 2007. Available formats: CD, FLAC/WAV download</p>
            <p><a class="btn btn-primary btn-sm" role="button">Buy Album / Singles</a>
          </div>
        {% endif %}
        <div class="video-player">
          <div id="jquery_jplayer_1"></div>
          <div id="jp_container_1">
            <a href="#" class="jp-play"><span class="glyphicon glyphicon-play"></span></a>
            <a href="#" class="jp-pause"><span class="glyphicon glyphicon-pause"></span></a>
          </div>
        </div>         
      {% endif %}
    {% endif %}
    {% if event.subtitle or event.description or event.link %}
      <div class="event-meta {% if request.GET.isfuture %} future{% endif %}">
        {% if event.subtitle %}
          <p>{{ event.subtitle }} {% if event.description and not request.GET.isfuture %}  <a href="" class="trigger-show-event-description">More info...</a> {% endif %}</p>
        {% endif %}
        {% if event.description %}
          <div class="description {% if not request.GET.isfuture %}none{% endif %}"> 
            {{ event.description|safe }}
          </div>
        {% endif %}
      </div>
    {% endif %}
    {# start track list #}
    {% if request.GET.hastracks %}
      <h4>(7) Downloads available from this video:</h4>
    {% endif %}
    {% if request.GET.hascd %}  
      <h4>Buy Tracks from the Album:</h4>
    {% endif %}
    {% if request.GET.hastracks or request.GET.hascd %}
      
    <table class="table table-striped">
      <thead>
        <tr>
          <th></th>
          <th>Song</th>
          <th>Composer</th>
          <th>Length</th>
          <th>Price</th>
          <th>Video cue</th>
        </tr>
      </thead>
      <tbody>
        {% include 'blocks/track-name.html' %}
        {% include 'blocks/track-name.html' %}
        {% include 'blocks/track-name.html' %}
        {% include 'blocks/track-name.html' %}
        {% include 'blocks/track-name.html' %}
        {% include 'blocks/track-name.html' %}
        {% include 'blocks/track-name.html' %}
      </tbody>
    </table>
    {# end track list #}
    {% endif %}
    {# start musician list #}
    <h4 class="text-muted">featuring:</h4> 
    {% for artist_info in performers %}
      <div class="sideman">
        <a href="{% url "artist_detail" pk=artist_info.artist.id %}">
        {% if artist_info.artist.photo.url != "" %}
          <img src="{% thumbor_url artist_info.artist.photo.url|urlencode width=80 height=80 smart=True %}" class="img-responsive artist-photo pull-left" />
        {% else %} 
          <img src="{% static 'image/photo-unavailable-square.svg' %}" width="80" height="80" class="img-responsive artist-photo pull-left" />
        {% endif %}
        <h3>{{ artist_info.artist.full_name }}</h3>
        {{ artist_info.artist.instruments.all|join:", " }} 
        <span class="media-count">(<span class="glyphicon glyphicon-music"></span> 6)</span>
        </a>
      </div>
    {% endfor %} 
    {# end musician list #}
  </div>
  <div class="col-sm-4">
  
    {% for artist_info in performers %}
      {% if artist_info.is_leader %}
      <h4>Recent Videos by {{ artist_info.artist.full_name }}</h4>
      <table class="table">
        <tbody>
          <tr>
            <td>[playButton]</td>
            <td><a href="{% url "event_detail" pk=412%}">{ pasteventwithaudio.date } - { pasteventwithaudio.displaytitle } </a></td>
          </tr>
          <tr>
            <td>[playButton]</td>
            <td><a href="{% url "event_detail" pk=412%}">{ pasteventwithaudio.date } - { pasteventwithaudio.displaytitle } </a></td>
          </tr>
          <tr>
            <td>[playButton]</td>
            <td><a href="{% url "event_detail" pk=412%}">{ pasteventwithaudio.date } - { pasteventwithaudio.displaytitle } </a></td>
          </tr> 
        </tbody>
      </table> 
      <p><a href="{% url "artist_detail" pk=412%}">Browse all (6) videos from {{ artist_info.artist.full_name }}</a></p>
      {% endif %}
    {% endfor %}

  </div>
</div>    
<div class="dev">
  <h1>Alternate States:</h1>
  <ul>
    <li><a href="./?">Past event</a> (default = no audio tracks)</li>
    <li><a href="./?hascd=1">Past event, w/ CD</a> {hascd} </li>
    <li><a href="./?hastracks=1">Past event, w/ live singles</a> {hastracks} </li>
    <li><a href="./?isfuture=1">Future/upcoming event</a> {isfuture}</li>
    <li><a href="./?islive=1">Live now event</a> {islive}</li>
    <li><a href="./?mediaUnavailable=1">Past event, no video</a> {mediaUnavailable}</li>
  </ul>
  <h1>Dev notes</h1>
  <Ul> 
    <li><code>1</code> -  </li> 
  </Ul>
</div>

{% endblock content %}
