{% load static from staticfiles %}
{% load thumbnail %}
{% load thumbor_tags %}


{% block content %}
    <section class="my-downloads-album__list container">
        {% with album=album_product is_hd=album_product%}
        <div class="my-downloads-album row big-player">
        <div class="my-downloads-album__cover flex-column player-container " data-track=0>
        {% with image=album.primary_image %}
            {% if album.parent_id %}
                {% with image=album.parent.primary_image %}
                    {% thumbnail image.original "245x245" upscale=False as thumb %}
                        <div style="position: relative">
                            <img class="defineImageRatio" src="{{ thumb.url }}" alt="{{ album.get_title }}">
                            <div class="purchases-player-button myplay-btn">
                                <div class="fa-thin-circle fa" >
                                <i class="fas fa-play"></i></div>
                            </div>
                        </div>
                    {% endthumbnail %}
                {% endwith %}
            {% else %}
                {% with image=album.primary_image %}
                    {% thumbnail image.original "245x245" upscale=False as thumb %}
                        <div style="position: relative">
                            <img class="defineImageRatio" src="{{ thumb.url }}" alt="{{ album.get_title }}">
                                <div class="purchases-player-button myplay-btn">
                                <div class="fa-thin-circle fa" >
                                <i class="fas fa-play"></i></div>
                            </div>
                        </div>
                    {% endthumbnail %}
                {% endwith %}
            {% endif %}
        {% endwith %}

            <a class="title6" href="{{ album.get_absolute_url }}">{% if album.parent %}{{ album.parent.title }} - {% endif %}{{ album.title }}</a>
        </div>
        <div class="song-container">
            <div class="my-downloads-album__tracks-table">
            {% for track in album_product.get_tracks %}
                <!-- tracks table row -->
                <div style="position:relative">
                    <div class="my-downloads-album__tracks-table__row flex-row">
                        <div class="progress-bar"></div>
                        <div class="hidden my-downloads-album__tracks-table__column audio">
                            <audio class="audio-player" controls data-track="{{ forloop.counter0 }}" data-length="{{track.attr.duration}}">
                            {% if is_hd %}
                                <source src="{{ track.get_hd_track_stockrecord.digital_download.get_file_url }}" type="audio/mpeg">
                            {% else %}
                                <source src="{{ track.get_track_stockrecord.digital_download.get_file_url }}" type="audio/mpeg">
                            {% endif %}

                            </audio>
                        </div>
                        <div class="flex-column track-info" data-track="{{ forloop.counter0 }}">
                            <div class="my-downloads-album__tracks-table__column title2">
                            {{ track.title }}
                            </div>
                            <div class="my-downloads-album__tracks-table__column composer text1">
                                {{ track.attr.composer }}
                            </div>
                        </div>
                        <div class="my-downloads-album__tracks-table__column duration text1">
                            {{ track.attr.duration }}
                        </div>
                        <div class="my-downloads-album__tracks-table__column buy-track">
                            <div class="buy-button-container">
                            <a class="white-border-button flex-button" data-toggle="dropdown" aria-expanded="false" href="">
                                    <span>Download</span> <i class="fa fa-caret-down"></i></a>
                            <div class="dropdown-menu" role="menu">
                                {% if is_hd %}
                                <a class="white-border-button no-border flex" href="{{ track.get_hd_track_stockrecord.digital_download.get_downloadable_file_url }}" download="{{ track.get_hd_track_stockrecord.digital_download.file.name }}">Download
                                    HD</a>
                                {% else %}
                                <a class="white-border-button no-border flex" href="{{ track.get_track_stockrecord.digital_download.get_downloadable_file_url }}" download="{{ track.get_track_stockrecord.digital_download.file.name }}">Download
                                    mp3</a>
                                {% endif %}

                            </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- end of tracks table row -->
            {% endfor %}
            </div>
            <!-- end of tracks table -->
        </div>
        </div>
        {% endwith %}
    </section>
{% endblock %}


{% comment %} <article class="event-display" > {% include 'promotions/featured_card.html' with event=album_product redirect=True secondary=secondary hide_play=True%}
    <div class="event-info">
        <div>
            <div class="event-info-title">{{ album_product.title }}</div>
        </div>
    </div>
</article>  {% endcomment %}